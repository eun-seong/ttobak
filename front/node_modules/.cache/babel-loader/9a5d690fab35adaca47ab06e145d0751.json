{"ast":null,"code":"var _jsxFileName = \"/Users/eun/Projects/FirstPenguin/first-penguin/front/src/Routes/Therapy/T4_Word/WordContainer.js\";\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport * as Sentry from '@sentry/browser';\nimport WordPresenter from './WordPresenter';\nimport { T1, TTobak, SoundEffect } from 'images';\nimport { T1_Api, soundURL, T_tutorial } from 'api';\nimport LoadingComp from 'Components/LoadingComp';\nconst inistState = {\n  cureText: null,\n  isRecording: false,\n  TTobaki: TTobak.ttobak1_1,\n  isImageLoaded: false,\n  showPopup: false,\n  showDonePopup: false,\n  showDailyPopup: false,\n  percent: 0,\n  currentIndex: 1,\n  totalNum: 0,\n  isPlaying: false,\n  RecordingCircle: false\n};\nconst PAUSED = 'PAUSED';\nconst PLAYING = 'PLAUING';\nconst RECORDING = 'RECORDING';\nconst AUDIOPLAYING = 'AUDIOPLAYING';\nconst failedMax = 3;\n\nclass Word extends React.Component {\n  constructor({\n    match\n  }) {\n    super();\n\n    this.newRequest = async () => {\n      console.log('new request');\n      const {\n        user\n      } = this.props;\n      const s_id = user.student.s_id;\n      console.log(s_id, this.idx_text);\n      const {\n        data\n      } = await T1_Api.ask(s_id, this.idx_text);\n      console.log(data);\n\n      if (data.code === 'tutorial') {\n        if (this.idx_text === 'vowelword') this.voweltutorial(data);else this.consotutorial(data);\n        return;\n      }\n\n      if (data.code === 'specified' || data.code === 1) {\n        this.currentIndex = 0;\n        this.cure = data.cure;\n        this.currentCure = data.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio.addEventListener('ended', this.currentAudioListner);\n        this.setState({\n          TTobaki: TTobak.ttobak1_1,\n          cureText: this.currentCure.cure_word,\n          totalNum: this.cure.length,\n          currentIndex: this.currentIndex + 1\n        });\n        setTimeout(() => {\n          this.playSound();\n        }, 2000);\n      }\n    };\n\n    this.daily = () => {\n      console.log(this.props.location.state.data);\n\n      if (this.props.location.state.data.code === 'tutorial') {\n        if (this.idx_text === 'vowelword') this.voweltutorial(this.props.location.state.data);else this.consotutorial(this.props.location.state.data);\n        return;\n      }\n\n      this.cure = this.props.location.state.data.read;\n      this.currentCure = this.cure[this.currentIndex];\n      this.currentCure.is_first = 'T';\n      this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio.addEventListener('ended', this.currentAudioListner);\n      this.setState({\n        totalNum: this.cure.length,\n        cureText: this.currentCure.cure_word,\n        currentIndex: this.currentIndex + 1\n      });\n      setTimeout(() => {\n        this.playSound();\n      }, 12000);\n    };\n\n    this.voweltutorial = data => {\n      this.isTutorial = true;\n      this.setState({\n        cureText: data.sample_ques.cure_word\n      });\n      this.currentCure = data.sample_ques;\n      this.tutorialAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio.addEventListener('ended', this.currentAudioListner);\n      this.voice = [new Audio(soundURL + data.tut_voice[0].voc_path), new Audio(soundURL + data.tut_voice[1].voc_path), new Audio(soundURL + data.tut_voice[2].voc_path), new Audio(soundURL + data.tut_voice[3].voc_path), new Audio(soundURL + data.tut_voice[4].voc_path), new Audio(soundURL + data.tut_voice[5].voc_path)];\n      this.voice[0].addEventListener('ended', () => {\n        setTimeout(() => {\n          this.tutorialAudio.play();\n        }, 1000);\n      });\n      this.tutorialAudio.addEventListener('ended', () => {\n        setTimeout(() => {\n          this.voice[1].play();\n        }, 1000);\n      });\n      this.voice[1].addEventListener('ended', () => {\n        setTimeout(() => {\n          this.recording_start_sound.play();\n          this.gameState = RECORDING;\n          this.setState({\n            isRecording: true,\n            RecordingCircle: true\n          });\n          this.setRecording = setInterval(() => {\n            this.setState({\n              RecordingCircle: !this.state.RecordingCircle\n            });\n          }, 500);\n          setTimeout(() => {\n            window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n          }, 200);\n        }, 800);\n      });\n\n      for (let i = 2; i < 5; i++) {\n        this.voice[i].addEventListener('ended', () => {\n          setTimeout(() => {\n            this.setState({\n              TTobaki: TTobak.ttobak3_1\n            });\n            setTimeout(() => {\n              if (!!this.currentAudio) {\n                this.playSound();\n                this.setState({\n                  TTobaki: TTobak.ttobak3_2,\n                  isPlaying: true\n                });\n              }\n            }, 1000);\n          }, 800);\n        });\n      }\n\n      this.voice[5].addEventListener('ended', async () => {\n        const {\n          data\n        } = await T_tutorial.answer(this.props.user.student.s_id, this.idx_text, this.currentCure.com_id);\n        console.log(data);\n        setTimeout(() => {\n          if (this.learning_type !== 'daily') this.newRequest();else this.daily();\n        }, 1000);\n\n        if (!!this.currentAudio) {\n          this.currentAudio.remove();\n          this.currentAudio = null;\n        }\n      });\n      setTimeout(() => {\n        this.voice[0].play();\n      }, 1000);\n    };\n\n    this.consotutorial = data => {\n      this.isTutorial = false;\n      this.setState({\n        cureText: data.sample_ques.cure_word\n      });\n      this.currentCure = data.sample_ques;\n      this.tutorialAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio.addEventListener('ended', this.currentAudioListner);\n      this.voice = [null, new Audio(soundURL + data.tut_voice[0].voc_path), new Audio(soundURL + data.tut_voice[1].voc_path), new Audio(soundURL + data.tut_voice[2].voc_path), new Audio(soundURL + data.tut_voice[3].voc_path), new Audio(soundURL + data.tut_voice[4].voc_path)];\n      this.voice[1].addEventListener('ended', () => {\n        setTimeout(() => {\n          this.recording_start_sound.play();\n          this.gameState = RECORDING;\n          this.setState({\n            isRecording: true,\n            RecordingCircle: true\n          });\n          this.setRecording = setInterval(() => {\n            this.setState({\n              RecordingCircle: !this.state.RecordingCircle\n            });\n          }, 500);\n          setTimeout(() => {\n            window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n          }, 200);\n        }, 800);\n      });\n\n      for (let i = 2; i < 5; i++) {\n        this.voice[i].addEventListener('ended', () => {\n          setTimeout(() => {\n            this.setState({\n              TTobaki: TTobak.ttobak3_1\n            });\n            setTimeout(() => {\n              if (!!this.currentAudio) {\n                this.playSound();\n                this.setState({\n                  TTobaki: TTobak.ttobak3_2,\n                  isPlaying: true\n                });\n              }\n            }, 1000);\n          }, 800);\n        });\n      }\n\n      this.voice[5].addEventListener('ended', async () => {\n        const {\n          data\n        } = await T_tutorial.answer(this.props.user.student.s_id, this.idx_text, this.currentCure.com_id);\n        console.log(data);\n        setTimeout(() => {\n          if (this.learning_type !== 'daily') this.newRequest();else this.daily();\n        }, 1000);\n\n        if (!!this.currentAudio) {\n          this.currentAudio.remove();\n          this.currentAudio = null;\n        }\n      });\n      setTimeout(() => {\n        this.voice[1].play();\n      }, 1000);\n    };\n\n    this.androidResponse = async e => {\n      console.log(e.detail);\n      this.audioResult = e.detail;\n      this.andriodListener();\n    };\n\n    this.stopRecording = e => {\n      console.log(e.detail);\n      clearInterval(this.setRecording);\n      this.recording_end_sound.play();\n      if (this.gameState !== PAUSED) this.gameState = PLAYING;\n      this.setState({\n        isRecording: false,\n        RecordingCircle: false\n      });\n    };\n\n    this.andriodListener = async () => {\n      if (this.gameState === PAUSED) return;\n      this.setState({\n        TTobaki: TTobak.ttobak2_1\n      });\n\n      if (this.audioResult.status === 'Success') {\n        if (this.isTutorial) {\n          if (this.audioResult.score < 85 && ++this.failedNum < failedMax) {\n            this.voice[2].play();\n          } else if (this.audioResult.rhythm_score < 0 && ++this.failedNum < failedMax) {\n            this.voice[3].play();\n          } else if (this.audioResult.speed_score < -5 && ++this.failedNum < failedMax) {\n            this.voice[4].play();\n          } else {\n            this.failedNum = 0;\n            this.voice[5].play();\n            this.isTutorial = false;\n          }\n\n          return;\n        }\n\n        const {\n          user\n        } = this.props;\n        const s_id = user.student.s_id;\n        const {\n          data\n        } = await T1_Api.answer(s_id, this.audioResult.score, this.audioResult.phone_score, this.audioResult.speed_score, this.audioResult.rhythm_score, this.learning_type === 'review' ? 'T' : 'F', this.currentCure.cure_id, this.idx_text, this.learning_type === 'daily' ? 'T' : 'F', this.currentCure.is_first);\n        console.log(data);\n\n        if (data.code === 1) {\n          if (!data.is_pass && ++this.failedNum < failedMax) {\n            this.currentCure.is_first = 'F';\n\n            if (!!this.retryAudio) {\n              this.retryAudio.remove();\n              this.retryAudio = null;\n            }\n\n            this.retryAudio = new Audio(soundURL + data.class_voice.voc_path);\n            this.retryAudio.addEventListener('ended', () => {\n              this.setState({\n                TTobaki: TTobak.ttobak3_1\n              });\n              setTimeout(() => {\n                this.playSound();\n              }, 1000);\n            });\n            setTimeout(() => {\n              if (!!this.retryAudio) {\n                this.retryAudio.play();\n                this.setState({\n                  TTobaki: TTobak.ttobak3_2\n                });\n              }\n            }, 1000);\n            return;\n          } else {\n            if (!!this.good_script) {\n              this.good_script.remove();\n              this.good_script = null;\n            }\n\n            this.failedNum = 0;\n            this.good_script = new Audio(soundURL + data.class_voice.voc_path);\n            this.good_script.addEventListener('ended', () => this.nextStep());\n            setTimeout(() => {\n              if (!!this.good_script) this.good_script.play();\n              this.setState({\n                TTobaki: TTobak.ttobak2_2\n              });\n            }, 1000);\n          }\n        } else if (data.code === 2) {\n          this.gameDone();\n        } else console.log(data.message);\n      } else {\n        console.log(this.audioResult.message);\n      }\n    };\n\n    this.nextStep = () => {\n      if (this.currentIndex < this.cure.length - 1) {\n        this.currentIndex++;\n      } else {\n        this.gameDone();\n        return;\n      }\n\n      this.currentCure = this.cure[this.currentIndex];\n      this.currentCure.is_first = 'T';\n\n      if (!!this.currentAudio) {\n        this.currentAudio.remove();\n        this.currentAudio = null;\n      }\n\n      this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio.addEventListener('ended', this.currentAudioListner);\n      setTimeout(() => {\n        this.setState({\n          TTobaki: TTobak.ttobak1_1,\n          cureText: this.currentCure.cure_word,\n          currentIndex: this.currentIndex + 1\n        });\n      }, 2000);\n      setTimeout(() => {\n        this.playSound();\n      }, 4000);\n    };\n\n    this.playSound = () => {\n      if (!!this.currentAudio) {\n        this.setState({\n          TTobaki: TTobak.ttobak3_2,\n          isPlaying: true\n        });\n        this.currentAudio.play();\n        this.gameState = AUDIOPLAYING;\n      }\n    };\n\n    this.currentAudioListner = () => {\n      this.setState({\n        TTobaki: TTobak.ttobak1_1,\n        isPlaying: false\n      });\n      setTimeout(() => {\n        this.recording_start_sound.play();\n        this.gameState = RECORDING;\n        this.setState({\n          isRecording: true,\n          RecordingCircle: true\n        });\n        this.setRecording = setInterval(() => {\n          this.setState({\n            RecordingCircle: !this.state.RecordingCircle\n          });\n        }, 500);\n        setTimeout(() => {\n          window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n        }, 200);\n      }, 800);\n    };\n\n    this.gameDone = () => {\n      console.log('game doen!');\n\n      if (this.learning_type !== 'daily') {\n        this.setState({\n          showDonePopup: true\n        });\n      } else {\n        this.setState({\n          showDailyPopup: true\n        });\n      }\n    };\n\n    this.imagesPreloading = picture => {\n      let timeoutPreloading = setTimeout(() => {\n        this.props.history.push('/main/main');\n      }, 10000);\n\n      for (let i in picture) {\n        for (let prop in picture[i]) {\n          let img = new Image();\n          img.src = picture[i][prop];\n\n          img.onload = () => {\n            this.setState({\n              percent: ++this.numOfLoadedImage / this.totalImages * 100\n            });\n\n            if (this.numOfLoadedImage === this.totalImages) {\n              this.setState({\n                isImageLoaded: true,\n                TTobaki: TTobak.ttobak1_1\n              });\n              clearTimeout(timeoutPreloading);\n              if (this.learning_type !== 'daily') this.newRequest();else this.daily();\n            }\n          };\n        }\n      }\n    };\n\n    this.onContinueButtonHandle = () => {\n      this.setState({\n        showPopup: false\n      });\n      setTimeout(() => {\n        this.continuePlay.play();\n        this.gameState = AUDIOPLAYING;\n\n        if (this.continuePlay === this.currentAudio) {\n          this.setState({\n            isPlaying: true\n          });\n        }\n\n        this.setState({\n          TTobaki: TTobak.ttobak3_2\n        });\n      }, 1000);\n    };\n\n    this.onRestartButtonHandle = () => {\n      this.setState({\n        showDonePopup: false\n      });\n      this.newRequest();\n      setTimeout(() => this.playSound(), 2000);\n    };\n\n    this.onPauseButtonHandle = () => {\n      if (this.gameState === RECORDING) {\n        window.BRIDGE.requestStopRecording();\n        this.continuePlay = this.currentAudio;\n      }\n\n      this.gameState = PAUSED;\n      this.setState({\n        showPopup: true\n      });\n      let audioArr = [this.currentAudio, this.voice, this.retryAudio, this.good_script];\n      console.log(audioArr);\n\n      for (let i = 0; i < audioArr.length; i++) {\n        if (!!audioArr[i] && !audioArr[i].paused && audioArr[i].duration > 0) {\n          audioArr[i].pause();\n          this.continuePlay = audioArr[i];\n          break;\n        }\n      }\n    };\n\n    this.onCompleteButtonHandle = () => {\n      if (this.state.isRecording) {\n        window.BRIDGE.requestStopRecording();\n      }\n    };\n\n    this.idx_text = match.params.type;\n    this.learning_type = match.params.learning_type;\n    this.recording_start_sound = new Audio(SoundEffect.recording_start);\n    this.recording_end_sound = new Audio(SoundEffect.recording_end);\n    this.cure = null;\n    this.currentCure = null;\n    this.currentIndex = 0;\n    this.currentAudio = null;\n    this.audioResult = null;\n    this.retryAudio = null;\n    this.picture = {\n      T1,\n      TTobak\n    };\n    this.totalImages = Object.keys(this.picture.T1).length + Object.keys(this.picture.TTobak).length;\n    this.numOfLoadedImage = 0;\n    this.continuePlay = false;\n    this.state = inistState;\n    this.failedNum = 0;\n    this.gameState = PLAYING;\n    this.isTutorial = false;\n    this.continuePlay = null;\n  }\n\n  async componentDidMount() {\n    const {\n      user\n    } = this.props;\n\n    if (!user.user.u_id || !user.student.s_id) {\n      this.props.history.push('/root/signin');\n      return;\n    }\n\n    this.imagesPreloading(this.picture);\n    window.addEventListener('android', this.androidResponse);\n    window.addEventListener('androidStopRecording', this.stopRecording);\n  }\n\n  componentWillUnmount() {\n    if (this.state.isRecording) {\n      window.BRIDGE.requestStopRecording();\n    }\n\n    let audioArr = [this.currentAudio, this.retryAudio, this.good_script];\n\n    for (let i = 0; i < audioArr.length; i++) {\n      if (!!audioArr[i]) {\n        audioArr[i].pause();\n        audioArr[i].remove();\n        audioArr[i] = null;\n      }\n    }\n\n    if (!!this.voice) {\n      for (let i = 0; i < this.voice.length; i++) {\n        if (!!this.voice[i]) {\n          this.voice[i].pause();\n          this.voice[i].remove();\n          this.voice[i] = null;\n        }\n      }\n    }\n\n    window.removeEventListener('android', this.androidResponse);\n    window.removeEventListener('androidStopRecording', this.stopRecording);\n  }\n\n  componentDidCatch(err, errorInfo) {\n    console.error(err);\n    this.setState(() => ({\n      err: true,\n      errorInfo: errorInfo\n    }));\n\n    if (process.env.NODE_ENV === 'production') {\n      Sentry.captureException(err, {\n        extra: errorInfo\n      });\n    }\n  }\n\n  render() {\n    const {\n      cureText,\n      TTobaki,\n      RecordingCircle,\n      isImageLoaded,\n      isPlaying,\n      showPopup,\n      showDonePopup,\n      showDailyPopup,\n      percent,\n      currentIndex,\n      totalNum\n    } = this.state;\n\n    if (this.state.err) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 614,\n          columnNumber: 20\n        }\n      }, \"error\");\n    }\n\n    if (isImageLoaded) {\n      return /*#__PURE__*/React.createElement(WordPresenter, {\n        Background: T1.t1_background,\n        TextBox: T1.t1_textbox,\n        bt_complete: T1.bt_complete,\n        TTobak: TTobaki,\n        isPlaying: isPlaying,\n        text: cureText,\n        RecordingCircle: RecordingCircle,\n        onCompleteButtonHandle: this.onCompleteButtonHandle,\n        onContinueButtonHandle: this.onContinueButtonHandle,\n        onRestartButtonHandle: this.onRestartButtonHandle,\n        onPauseButtonHandle: this.onPauseButtonHandle,\n        showPopup: showPopup,\n        showDailyPopup: showDailyPopup,\n        showDonePopup: showDonePopup,\n        currentIndex: currentIndex,\n        totalNum: totalNum,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 618,\n          columnNumber: 21\n        }\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(LoadingComp, {\n        percent: percent,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 634,\n          columnNumber: 20\n        }\n      });\n    }\n  }\n\n}\n\nWord.propTypes = {\n  user: PropTypes.objectOf(PropTypes.any).isRequired,\n  dispatch: PropTypes.func.isRequired\n};\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n}\n\nexport default connect(mapStateToProps)(withRouter(Word));","map":{"version":3,"sources":["/Users/eun/Projects/FirstPenguin/first-penguin/front/src/Routes/Therapy/T4_Word/WordContainer.js"],"names":["React","withRouter","PropTypes","connect","Sentry","WordPresenter","T1","TTobak","SoundEffect","T1_Api","soundURL","T_tutorial","LoadingComp","inistState","cureText","isRecording","TTobaki","ttobak1_1","isImageLoaded","showPopup","showDonePopup","showDailyPopup","percent","currentIndex","totalNum","isPlaying","RecordingCircle","PAUSED","PLAYING","RECORDING","AUDIOPLAYING","failedMax","Word","Component","constructor","match","newRequest","console","log","user","props","s_id","student","idx_text","data","ask","code","voweltutorial","consotutorial","cure","currentCure","is_first","currentAudio","Audio","cure_path","addEventListener","currentAudioListner","setState","cure_word","length","setTimeout","playSound","daily","location","state","read","isTutorial","sample_ques","tutorialAudio","voice","tut_voice","voc_path","play","recording_start_sound","gameState","setRecording","setInterval","window","BRIDGE","recordAudio","gender","i","ttobak3_1","ttobak3_2","answer","com_id","learning_type","remove","androidResponse","e","detail","audioResult","andriodListener","stopRecording","clearInterval","recording_end_sound","ttobak2_1","status","score","failedNum","rhythm_score","speed_score","phone_score","cure_id","is_pass","retryAudio","class_voice","good_script","nextStep","ttobak2_2","gameDone","message","imagesPreloading","picture","timeoutPreloading","history","push","prop","img","Image","src","onload","numOfLoadedImage","totalImages","clearTimeout","onContinueButtonHandle","continuePlay","onRestartButtonHandle","onPauseButtonHandle","requestStopRecording","audioArr","paused","duration","pause","onCompleteButtonHandle","params","type","recording_start","recording_end","Object","keys","componentDidMount","u_id","componentWillUnmount","removeEventListener","componentDidCatch","err","errorInfo","error","process","env","NODE_ENV","captureException","extra","render","t1_background","t1_textbox","bt_complete","propTypes","objectOf","any","isRequired","dispatch","func","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport * as Sentry from '@sentry/browser';\n\nimport WordPresenter from './WordPresenter';\nimport { T1, TTobak, SoundEffect } from 'images';\nimport { T1_Api, soundURL, T_tutorial } from 'api';\nimport LoadingComp from 'Components/LoadingComp';\n\nconst inistState = {\n    cureText: null,\n    isRecording: false,\n    TTobaki: TTobak.ttobak1_1,\n    isImageLoaded: false,\n    showPopup: false,\n    showDonePopup: false,\n    showDailyPopup: false,\n    percent: 0,\n    currentIndex: 1,\n    totalNum: 0,\n    isPlaying: false,\n    RecordingCircle: false,\n};\n\nconst PAUSED = 'PAUSED';\nconst PLAYING = 'PLAUING';\nconst RECORDING = 'RECORDING';\nconst AUDIOPLAYING = 'AUDIOPLAYING';\nconst failedMax = 3;\n\nclass Word extends React.Component {\n    static propTypes = {\n        user: PropTypes.objectOf(PropTypes.any).isRequired,\n        dispatch: PropTypes.func.isRequired,\n    };\n\n    constructor({ match }) {\n        super();\n        this.idx_text = match.params.type;\n        this.learning_type = match.params.learning_type;\n        this.recording_start_sound = new Audio(SoundEffect.recording_start);\n        this.recording_end_sound = new Audio(SoundEffect.recording_end);\n        this.cure = null;\n        this.currentCure = null;\n        this.currentIndex = 0;\n        this.currentAudio = null;\n        this.audioResult = null;\n        this.retryAudio = null;\n        this.picture = { T1, TTobak };\n        this.totalImages = Object.keys(this.picture.T1).length + Object.keys(this.picture.TTobak).length;\n        this.numOfLoadedImage = 0;\n        this.continuePlay = false;\n        this.state = inistState;\n        this.failedNum = 0;\n        this.gameState = PLAYING;\n        this.isTutorial = false;\n        this.continuePlay = null;\n    }\n\n    async componentDidMount() {\n        const { user } = this.props;\n\n        if (!user.user.u_id || !user.student.s_id) {\n            this.props.history.push('/root/signin');\n            return;\n        }\n\n        this.imagesPreloading(this.picture);\n\n        window.addEventListener('android', this.androidResponse);\n        window.addEventListener('androidStopRecording', this.stopRecording);\n    }\n\n    componentWillUnmount() {\n        if (this.state.isRecording) {\n            window.BRIDGE.requestStopRecording();\n        }\n        let audioArr = [this.currentAudio, this.retryAudio, this.good_script];\n        for (let i = 0; i < audioArr.length; i++) {\n            if (!!audioArr[i]) {\n                audioArr[i].pause();\n                audioArr[i].remove();\n                audioArr[i] = null;\n            }\n        }\n\n        if (!!this.voice) {\n            for (let i = 0; i < this.voice.length; i++) {\n                if (!!this.voice[i]) {\n                    this.voice[i].pause();\n                    this.voice[i].remove();\n                    this.voice[i] = null;\n                }\n            }\n        }\n        window.removeEventListener('android', this.androidResponse);\n        window.removeEventListener('androidStopRecording', this.stopRecording);\n    }\n\n    componentDidCatch(err, errorInfo) {\n        console.error(err);\n        this.setState(() => ({\n            err: true,\n            errorInfo: errorInfo,\n        }));\n\n        if (process.env.NODE_ENV === 'production') {\n            Sentry.captureException(err, { extra: errorInfo });\n        }\n    }\n\n    newRequest = async () => {\n        console.log('new request');\n        const { user } = this.props;\n        const s_id = user.student.s_id;\n\n        console.log(s_id, this.idx_text)\n        const { data } = await T1_Api.ask(s_id, this.idx_text);\n        console.log(data);\n\n        if (data.code === 'tutorial') {\n            if (this.idx_text === 'vowelword') this.voweltutorial(data);\n            else this.consotutorial(data);\n            return;\n        }\n\n        if (data.code === 'specified' || data.code === 1) {\n            this.currentIndex = 0;\n            this.cure = data.cure;\n            this.currentCure = data.cure[this.currentIndex];\n            this.currentCure.is_first = 'T';\n            this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n            this.currentAudio.addEventListener('ended', this.currentAudioListner);\n\n            this.setState({\n                TTobaki: TTobak.ttobak1_1,\n                cureText: this.currentCure.cure_word,\n                totalNum: this.cure.length,\n                currentIndex: this.currentIndex + 1,\n            });\n            setTimeout(() => {\n                this.playSound();\n            }, 2000);\n        }\n    }\n\n    daily = () => {\n        console.log(this.props.location.state.data);\n\n        if (this.props.location.state.data.code === 'tutorial') {\n            if (this.idx_text === 'vowelword') this.voweltutorial(this.props.location.state.data);\n            else this.consotutorial(this.props.location.state.data);\n            return;\n        }\n\n        this.cure = this.props.location.state.data.read;\n        this.currentCure = this.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio.addEventListener('ended', this.currentAudioListner);\n\n        this.setState({\n            totalNum: this.cure.length,\n            cureText: this.currentCure.cure_word,\n            currentIndex: this.currentIndex + 1,\n        });\n\n        setTimeout(() => {\n            this.playSound();\n        }, 12000);\n    }\n\n    voweltutorial = (data) => {\n        this.isTutorial = true;\n        this.setState({\n            cureText: data.sample_ques.cure_word,\n        });\n\n        this.currentCure = data.sample_ques;\n        this.tutorialAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio.addEventListener('ended', this.currentAudioListner);\n        this.voice = [\n            new Audio(soundURL + data.tut_voice[0].voc_path),\n            new Audio(soundURL + data.tut_voice[1].voc_path),\n            new Audio(soundURL + data.tut_voice[2].voc_path),\n            new Audio(soundURL + data.tut_voice[3].voc_path),\n            new Audio(soundURL + data.tut_voice[4].voc_path),\n            new Audio(soundURL + data.tut_voice[5].voc_path),\n        ];\n\n        this.voice[0].addEventListener('ended', () => {\n            setTimeout(() => {\n                this.tutorialAudio.play();\n            }, 1000);\n        });\n\n        this.tutorialAudio.addEventListener('ended', () => {\n            setTimeout(() => {\n                this.voice[1].play();\n            }, 1000);\n        });\n\n        this.voice[1].addEventListener('ended', () => {\n            setTimeout(() => {\n                this.recording_start_sound.play();\n                this.gameState = RECORDING;\n                this.setState({\n                    isRecording: true,\n                    RecordingCircle: true,\n                })\n                this.setRecording = setInterval(() => {\n                    this.setState({\n                        RecordingCircle: !this.state.RecordingCircle,\n                    });\n                }, 500);\n                setTimeout(() => {\n                    window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n                }, 200);\n            }, 800);\n        });\n\n        for (let i = 2; i < 5; i++) {\n            this.voice[i].addEventListener('ended', () => {\n                setTimeout(() => {\n                    this.setState({\n                        TTobaki: TTobak.ttobak3_1,\n                    })\n                    setTimeout(() => {\n                        if (!!this.currentAudio) {\n                            this.playSound();\n                            this.setState({\n                                TTobaki: TTobak.ttobak3_2,\n                                isPlaying: true,\n                            })\n                        }\n                    }, 1000);\n                }, 800);\n            })\n        }\n\n        this.voice[5].addEventListener('ended', async () => {\n            const { data } = await T_tutorial.answer(\n                this.props.user.student.s_id,\n                this.idx_text,\n                this.currentCure.com_id);\n            console.log(data);\n            setTimeout(() => {\n                if (this.learning_type !== 'daily') this.newRequest();\n                else this.daily();\n            }, 1000);\n            if (!!this.currentAudio) {\n                this.currentAudio.remove();\n                this.currentAudio = null;\n            }\n        })\n\n        setTimeout(() => {\n            this.voice[0].play();\n        }, 1000);\n    }\n\n    consotutorial = (data) => {\n        this.isTutorial = false;\n        this.setState({\n            cureText: data.sample_ques.cure_word,\n        });\n\n        this.currentCure = data.sample_ques;\n        this.tutorialAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio.addEventListener('ended', this.currentAudioListner);\n        this.voice = [\n            null,\n            new Audio(soundURL + data.tut_voice[0].voc_path),\n            new Audio(soundURL + data.tut_voice[1].voc_path),\n            new Audio(soundURL + data.tut_voice[2].voc_path),\n            new Audio(soundURL + data.tut_voice[3].voc_path),\n            new Audio(soundURL + data.tut_voice[4].voc_path),\n        ];\n\n        this.voice[1].addEventListener('ended', () => {\n            setTimeout(() => {\n                this.recording_start_sound.play();\n                this.gameState = RECORDING;\n                this.setState({\n                    isRecording: true,\n                    RecordingCircle: true,\n                })\n                this.setRecording = setInterval(() => {\n                    this.setState({\n                        RecordingCircle: !this.state.RecordingCircle,\n                    });\n                }, 500);\n                setTimeout(() => {\n                    window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n                }, 200);\n            }, 800);\n        });\n\n        for (let i = 2; i < 5; i++) {\n            this.voice[i].addEventListener('ended', () => {\n                setTimeout(() => {\n                    this.setState({\n                        TTobaki: TTobak.ttobak3_1,\n                    })\n                    setTimeout(() => {\n                        if (!!this.currentAudio) {\n                            this.playSound();\n                            this.setState({\n                                TTobaki: TTobak.ttobak3_2,\n                                isPlaying: true,\n                            })\n                        }\n                    }, 1000);\n                }, 800);\n            })\n        }\n\n        this.voice[5].addEventListener('ended', async () => {\n            const { data } = await T_tutorial.answer(\n                this.props.user.student.s_id,\n                this.idx_text,\n                this.currentCure.com_id);\n            console.log(data);\n            setTimeout(() => {\n                if (this.learning_type !== 'daily') this.newRequest();\n                else this.daily();\n            }, 1000);\n            if (!!this.currentAudio) {\n                this.currentAudio.remove();\n                this.currentAudio = null;\n            }\n        })\n\n        setTimeout(() => {\n            this.voice[1].play();\n        }, 1000);\n    }\n\n    androidResponse = async (e) => {\n        console.log(e.detail);\n        this.audioResult = e.detail;\n        this.andriodListener();\n    }\n\n    stopRecording = (e) => {\n        console.log(e.detail);\n        clearInterval(this.setRecording);\n        this.recording_end_sound.play();\n        if (this.gameState !== PAUSED) this.gameState = PLAYING;\n        this.setState({\n            isRecording: false,\n            RecordingCircle: false,\n        });\n    }\n\n    andriodListener = async () => {\n        if (this.gameState === PAUSED) return;\n        this.setState({\n            TTobaki: TTobak.ttobak2_1,\n        });\n\n        if (this.audioResult.status === 'Success') {\n            if (this.isTutorial) {\n                if (this.audioResult.score < 85 && ++this.failedNum < failedMax) {\n                    this.voice[2].play();\n                } else if (this.audioResult.rhythm_score < 0 && ++this.failedNum < failedMax) {\n                    this.voice[3].play();\n                } else if (this.audioResult.speed_score < -5 && ++this.failedNum < failedMax) {\n                    this.voice[4].play();\n                } else {\n                    this.failedNum = 0;\n                    this.voice[5].play();\n                    this.isTutorial = false;\n                }\n                return;\n            }\n\n            const { user } = this.props;\n            const s_id = user.student.s_id;\n            const { data } = await T1_Api.answer(\n                s_id,\n                this.audioResult.score,\n                this.audioResult.phone_score,\n                this.audioResult.speed_score,\n                this.audioResult.rhythm_score,\n                this.learning_type === 'review' ? 'T' : 'F',\n                this.currentCure.cure_id,\n                this.idx_text,\n                this.learning_type === 'daily' ? 'T' : 'F',\n                this.currentCure.is_first\n            );\n            console.log(data);\n\n            if (data.code === 1) {\n                if (!data.is_pass && ++this.failedNum < failedMax) {\n                    this.currentCure.is_first = 'F';\n                    if (!!this.retryAudio) {\n                        this.retryAudio.remove();\n                        this.retryAudio = null;\n                    }\n                    this.retryAudio = new Audio(soundURL + data.class_voice.voc_path);\n                    this.retryAudio.addEventListener('ended', () => {\n                        this.setState({\n                            TTobaki: TTobak.ttobak3_1,\n                        })\n                        setTimeout(() => {\n                            this.playSound();\n                        }, 1000);\n                    });\n\n                    setTimeout(() => {\n                        if (!!this.retryAudio) {\n                            this.retryAudio.play();\n                            this.setState({\n                                TTobaki: TTobak.ttobak3_2,\n                            });\n                        }\n                    }, 1000);\n                    return;\n                } else {\n                    if (!!this.good_script) {\n                        this.good_script.remove();\n                        this.good_script = null;\n                    }\n                    this.failedNum = 0;\n                    this.good_script = new Audio(soundURL + data.class_voice.voc_path);\n                    this.good_script.addEventListener('ended', () => this.nextStep());\n                    setTimeout(() => {\n                        if (!!this.good_script) this.good_script.play();\n                        this.setState({\n                            TTobaki: TTobak.ttobak2_2,\n                        });\n                    }, 1000);\n                }\n\n            } else if (data.code === 2) {\n                this.gameDone();\n            }\n            else console.log(data.message);\n\n        } else {\n            console.log(this.audioResult.message);\n        }\n    }\n\n    nextStep = () => {\n        if (this.currentIndex < this.cure.length - 1) {\n            this.currentIndex++;\n        } else {\n            this.gameDone();\n            return;\n        }\n        this.currentCure = this.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        if (!!this.currentAudio) {\n            this.currentAudio.remove();\n            this.currentAudio = null;\n        }\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n        this.currentAudio.addEventListener('ended', this.currentAudioListner);\n\n        setTimeout(() => {\n            this.setState({\n                TTobaki: TTobak.ttobak1_1,\n                cureText: this.currentCure.cure_word,\n                currentIndex: this.currentIndex + 1\n            });\n        }, 2000);\n\n        setTimeout(() => {\n            this.playSound();\n        }, 4000);\n    }\n\n    playSound = () => {\n        if (!!this.currentAudio) {\n            this.setState({\n                TTobaki: TTobak.ttobak3_2,\n                isPlaying: true,\n            });\n            this.currentAudio.play();\n            this.gameState = AUDIOPLAYING;\n        }\n    }\n\n    currentAudioListner = () => {\n        this.setState({\n            TTobaki: TTobak.ttobak1_1,\n            isPlaying: false,\n        });\n        setTimeout(() => {\n            this.recording_start_sound.play();\n            this.gameState = RECORDING;\n            this.setState({\n                isRecording: true,\n                RecordingCircle: true,\n            })\n            this.setRecording = setInterval(() => {\n                this.setState({\n                    RecordingCircle: !this.state.RecordingCircle,\n                });\n            }, 500);\n            setTimeout(() => {\n                window.BRIDGE.recordAudio(this.props.user.student.gender, this.currentCure.cure_word);\n            }, 200);\n        }, 800);\n    };\n\n    gameDone = () => {\n        console.log('game doen!');\n        if (this.learning_type !== 'daily') {\n            this.setState({\n                showDonePopup: true,\n            })\n        } else {\n            this.setState({\n                showDailyPopup: true,\n            })\n        }\n    }\n\n    imagesPreloading = (picture) => {\n        let timeoutPreloading = setTimeout(() => {\n            this.props.history.push('/main/main');\n        }, 10000);\n\n        for (let i in picture) {\n            for (let prop in picture[i]) {\n                let img = new Image();\n                img.src = picture[i][prop];\n                img.onload = () => {\n                    this.setState({\n                        percent: (++this.numOfLoadedImage / this.totalImages) * 100\n                    })\n                    if (this.numOfLoadedImage === this.totalImages) {\n                        this.setState({\n                            isImageLoaded: true,\n                            TTobaki: TTobak.ttobak1_1,\n                        });\n                        clearTimeout(timeoutPreloading);\n                        if (this.learning_type !== 'daily') this.newRequest();\n                        else this.daily();\n                    }\n                };\n            }\n        }\n    }\n\n    onContinueButtonHandle = () => {\n        this.setState({\n            showPopup: false,\n        });\n\n        setTimeout(() => {\n            this.continuePlay.play();\n            this.gameState = AUDIOPLAYING;\n            if (this.continuePlay === this.currentAudio) {\n                this.setState({\n                    isPlaying: true,\n                });\n            }\n            this.setState({\n                TTobaki: TTobak.ttobak3_2,\n            });\n        }, 1000);\n    }\n\n    onRestartButtonHandle = () => {\n        this.setState({\n            showDonePopup: false,\n        })\n        this.newRequest();\n        setTimeout(() => this.playSound(), 2000);\n    }\n\n    onPauseButtonHandle = () => {\n        if (this.gameState === RECORDING) {\n            window.BRIDGE.requestStopRecording();\n            this.continuePlay = this.currentAudio;\n        }\n        this.gameState = PAUSED;\n        this.setState({\n            showPopup: true,\n        });\n\n        let audioArr = [this.currentAudio, this.voice, this.retryAudio, this.good_script];\n        console.log(audioArr)\n\n        for (let i = 0; i < audioArr.length; i++) {\n            if (!!audioArr[i] && !audioArr[i].paused && audioArr[i].duration > 0) {\n                audioArr[i].pause();\n                this.continuePlay = audioArr[i];\n                break;\n            }\n        }\n    }\n\n    onCompleteButtonHandle = () => {\n        if (this.state.isRecording) {\n            window.BRIDGE.requestStopRecording();\n        }\n    }\n\n    render() {\n        const { cureText, TTobaki, RecordingCircle, isImageLoaded, isPlaying,\n            showPopup, showDonePopup, showDailyPopup, percent,\n            currentIndex, totalNum } = this.state;\n\n        if (this.state.err) {\n            return <div>error</div>;\n        }\n\n        if (isImageLoaded) {\n            return (<WordPresenter\n                Background={T1.t1_background} TextBox={T1.t1_textbox} bt_complete={T1.bt_complete}\n                TTobak={TTobaki} isPlaying={isPlaying}\n                text={cureText} RecordingCircle={RecordingCircle}\n                onCompleteButtonHandle={this.onCompleteButtonHandle}\n                onContinueButtonHandle={this.onContinueButtonHandle}\n                onRestartButtonHandle={this.onRestartButtonHandle}\n                onPauseButtonHandle={this.onPauseButtonHandle}\n                showPopup={showPopup}\n                showDailyPopup={showDailyPopup}\n                showDonePopup={showDonePopup}\n                currentIndex={currentIndex}\n                totalNum={totalNum}\n            />);\n        }\n        else {\n            return <LoadingComp percent={percent} />\n        }\n    }\n}\n\nfunction mapStateToProps(state) {\n    return { user: state.user }\n}\n\nexport default connect(mapStateToProps)(withRouter(Word));"]},"metadata":{},"sourceType":"module"}