{"ast":null,"code":"var _jsxFileName = \"/Users/eun/Projects/FirstPenguin/first-penguin/front/src/Routes/Therapy/T5_Sound/SoundContainer.js\";\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport SoundPresenter from './SoundPresenter';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { T5, TTobak, Characters } from 'images';\nimport { T_Api2, soundURL, T_tutorial } from 'api';\nimport LoadingComp from 'Components/LoadingComp';\nconst initState = {\n  TTobaki: TTobak.ttobak1_1,\n  // 또박이 이미지 상태\n  gameState: false,\n  CardTextList: null,\n  isImageLoaded: false,\n  showPopup: false,\n  showDonePopup: false,\n  showDailyPopup: false,\n  percent: 0,\n  currentIndex: 1,\n  totalNum: 0\n};\n\nclass Sound extends React.Component {\n  constructor({\n    match\n  }) {\n    super();\n\n    this.newRequest = async () => {\n      console.log('new request');\n      const {\n        user\n      } = this.props;\n      const s_id = user.student.s_id;\n      const {\n        data\n      } = await T_Api2.ask(s_id, this.type);\n      console.log(data);\n\n      if (data.code === 'tutorial') {\n        this.tutorial(data);\n        return;\n      }\n\n      if (data.code === 'specified' || data.code === 1) {\n        this.currentIndex = 0;\n        this.cure = data.cure;\n        this.currentCure = data.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        this.setAudio();\n        this.setState({\n          CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n          totalNum: this.cure.length,\n          currentIndex: this.currentIndex + 1\n        });\n        setTimeout(() => this.playSound(), 2000);\n      } else console.log('data message: ' + data.message);\n    };\n\n    this.daily = () => {\n      if (this.props.location.state.data.code === 'tutorial') {\n        this.tutorial(this.props.location.state.data);\n        return;\n      }\n\n      console.log(this.props.location.state.data.cure);\n      this.cure = this.props.location.state.data.cure;\n      this.currentCure = this.cure[this.currentIndex];\n      this.currentCure.is_first = 'T';\n      this.setAudio();\n      this.setState = {\n        totalNum: this.cure.length,\n        CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n        currentIndex: this.currentIndex + 1\n      };\n      setTimeout(() => this.playSound(), 2000);\n    };\n\n    this.tutorial = data => {\n      this.voice = [new Audio(soundURL + data.tut_voice[0].voc_path), new Audio(soundURL + data.tut_voice[1].voc_path), new Audio(soundURL + data.tut_voice[2].voc_path)];\n      this.currentCure = data.sample_ques;\n      this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n      this.currentAudio.addEventListener('ended', () => {\n        this.setState({\n          TTobaki: TTobak.ttobak1_1\n        });\n        setTimeout(() => {\n          this.voice[1].play();\n        }, 1000);\n      });\n      this.setState({\n        CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2]\n      });\n      this.voice[0].addEventListener('ended', () => {\n        setTimeout(() => {\n          this.playSound();\n        }, 1000);\n      });\n      this.voice[1].addEventListener('ended', () => {\n        this.setState({\n          gameState: 'tutorial',\n          TTobaki: TTobak.ttobak1_1\n        });\n      });\n      this.voice[2].addEventListener('ended', async () => {\n        const {\n          data\n        } = await T_tutorial.answer(this.props.user.student.s_id, this.type, this.currentCure.cure_id);\n        console.log(data);\n        this.setState({\n          gameState: false\n        });\n        if (this.learning_type === 'daily') this.daily();else this.newRequest();\n      });\n      setTimeout(() => {\n        this.voice[0].play();\n      }, 2000);\n    };\n\n    this.setAudio = () => {\n      if (!!this.currentAudio) {\n        this.currentAudio.remove();\n        this.currentAudio = null;\n      }\n\n      if (this.type === 'consosound') {\n        this.currentCure.answer = Math.floor(Math.random() * 2) + 1;\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n\n        if (this.currentCure.answer === 2) {\n          var tmp = this.currentCure.cure_word;\n          this.currentCure.cure_word = this.currentCure.cure_word2;\n          this.currentCure.cure_word2 = tmp;\n        }\n      } else {\n        this.currentAudio = this.currentCure.answer === 1 ? new Audio(soundURL + this.currentCure.cure_path) : new Audio(soundURL + this.currentCure.cure_path2);\n      }\n\n      this.currentAudio.addEventListener('ended', () => {\n        setTimeout(() => {\n          this.voice[1].play();\n        }, 1000);\n      });\n    };\n\n    this.playSound = () => {\n      if (!!this.currentAudio) {\n        this.setState({\n          gameState: false,\n          TTobaki: TTobak.ttobak1_2\n        });\n        this.currentAudio.play();\n      }\n    };\n\n    this.onTTobakiTouchHandle = () => {\n      const {\n        gameState\n      } = this.state;\n      if (gameState) this.playSound();\n    };\n\n    this.onCardTouchHandle = async index => {\n      const {\n        gameState,\n        CardTextList\n      } = this.state;\n      const {\n        user\n      } = this.props;\n      const s_id = user.student.s_id;\n\n      if (gameState === 'tutorial') {\n        if (index === 1) {\n          this.setState({\n            gameState: false\n          });\n          setTimeout(() => {\n            this.voice[2].play();\n          }, 1000);\n        }\n\n        return;\n      }\n\n      if (!gameState) return;\n      this.setState({\n        gameState: false\n      });\n      const {\n        data\n      } = await T_Api2.answer(s_id, this.currentCure.answer === 1 ? this.currentCure.cure_word : this.currentCure.cure_word2, CardTextList[index], this.currentCure.cure_id, this.learning_type === 'review' ? 'T' : 'F', this.type, this.learning_type === 'daily' ? 'T' : 'F', this.currentCure.is_first);\n      console.log(data);\n\n      if (data.code === 1) {\n        if (data.correct_voice.voc_desc === 'retry') {\n          this.currentCure.is_first = 'F';\n          this.retry_script = new Audio(soundURL + data.correct_voice.voc_path);\n          this.retry_script.addEventListener('ended', () => {\n            this.setState({\n              TTobaki: TTobak.ttobak1_1,\n              gameState: true\n            });\n          });\n          setTimeout(() => {\n            this.retry_script.play();\n            this.setState({\n              TTobaki: TTobak.ttobak3_2,\n              gameState: false\n            });\n          }, 1000);\n          return;\n        } else {\n          this.setState({\n            TTobaki: TTobak.ttobak2_2\n          });\n          this.good_script = new Audio(soundURL + data.correct_voice.voc_path);\n          this.good_script.addEventListener('ended', () => this.nextStep());\n          setTimeout(() => {\n            this.good_script.play();\n            this.setState({\n              gameState: false\n            });\n          }, 1000);\n        }\n      } else if (data.code === 2) {\n        this.setState({\n          showPopup: true\n        });\n      }\n    };\n\n    this.nextStep = () => {\n      if (this.currentIndex < this.cure.length - 1) this.currentIndex++;else {\n        setTimeout(() => {\n          this.gameDone();\n        }, 1000);\n        return;\n      }\n      this.currentCure = this.cure[this.currentIndex];\n      this.currentCure.is_first = 'T';\n      this.setAudio();\n      setTimeout(() => {\n        this.setState({\n          CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n          TTobaki: TTobak.ttobak1_1,\n          currentIndex: this.currentIndex + 1\n        });\n      }, 1000);\n      setTimeout(() => {\n        this.playSound();\n      }, 2000);\n    };\n\n    this.gameDone = () => {\n      console.log('game doen!');\n\n      if (this.learning_type !== 'daily') {\n        this.setState({\n          showDonePopup: true\n        });\n      } else {\n        this.setState({\n          showDailyPopup: true\n        });\n      }\n    };\n\n    this.imagesPreloading = picture => {\n      let timeoutPreloading = setTimeout(() => {\n        this.props.history.push('/main/main');\n      }, 10000);\n\n      for (let i in picture) {\n        for (let prop in picture[i]) {\n          let img = new Image();\n          img.src = picture[i][prop];\n\n          img.onload = () => {\n            this.setState({\n              percent: ++this.numOfLoadedImage / this.totalImages * 100\n            });\n\n            if (this.numOfLoadedImage === this.totalImages) {\n              this.setState({\n                isImageLoaded: true,\n                TTobaki: TTobak.ttobak1_1\n              });\n              clearTimeout(timeoutPreloading);\n              if (this.learning_type !== 'daily') this.newRequest();else this.daily();\n            }\n          };\n        }\n      }\n    };\n\n    this.onContinueButtonHandle = () => {\n      this.setState({\n        showPopup: false\n      });\n    };\n\n    this.onRestartButtonHandle = () => {\n      this.setState({\n        showDonePopup: false\n      });\n      this.newRequest();\n      setTimeout(() => this.playSound(), 2000);\n    };\n\n    this.onPauseButtonHandle = () => {\n      this.setState({\n        showPopup: true\n      });\n    };\n\n    this.learning_type = match.params.learning_type;\n    this.type = match.params.type + 'sound';\n    this.cure = null;\n    this.currentCure = null;\n    this.currentIndex = 0;\n    this.currentAudio = null;\n    this.numOfLoadedImage = 0;\n    this.picture = {\n      T5,\n      TTobak,\n      Characters\n    };\n    this.totalImages = Object.keys(T5).length + Object.keys(TTobak).length + Object.keys(Characters).length;\n    this.state = initState;\n  }\n\n  async componentDidMount() {\n    const {\n      user\n    } = this.props;\n\n    if (!user.user.u_id || !user.student.s_id) {\n      this.props.history.push('/root/signin');\n      return;\n    }\n\n    this.imagesPreloading(this.picture);\n  }\n\n  componentWillUnmount() {\n    if (!!this.currentAudio) {\n      this.currentAudio.pause();\n      this.currentAudio.remove();\n      this.currentAudio = null;\n    }\n\n    if (!!this.voice) {\n      for (let i = 0; i < this.voice.length; i++) {\n        if (!!this.voice[i]) {\n          this.voice[i].pause();\n          this.voice[i].remove();\n          this.voice[i] = null;\n        }\n      }\n    }\n  }\n\n  render() {\n    const {\n      TTobaki,\n      CardTextList,\n      isImageLoaded,\n      showPopup,\n      showDonePopup,\n      showDailyPopup,\n      percent,\n      gameState,\n      currentIndex,\n      totalNum\n    } = this.state;\n\n    if (isImageLoaded) {\n      return /*#__PURE__*/React.createElement(SoundPresenter, {\n        Background: T5.t5_background,\n        TTobak: TTobaki,\n        TTobakiTouch: this.onTTobakiTouchHandle,\n        Card: [Characters.card1, Characters.card2],\n        CardTextList: CardTextList || ['아', '에'],\n        onCardTouchHandle: this.onCardTouchHandle,\n        onContinueButtonHandle: this.onContinueButtonHandle,\n        onRestartButtonHandle: this.onRestartButtonHandle,\n        onPauseButtonHandle: this.onPauseButtonHandle,\n        showPopup: showPopup,\n        showDailyPopup: showDailyPopup,\n        showDonePopup: showDonePopup,\n        gameState: gameState,\n        currentIndex: currentIndex,\n        totalNum: totalNum,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 21\n        }\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(LoadingComp, {\n        percent: percent,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 20\n        }\n      });\n    }\n  }\n\n}\n\nSound.propTypes = {\n  user: PropTypes.objectOf(PropTypes.any).isRequired,\n  dispatch: PropTypes.func.isRequired\n};\n\nfunction mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n}\n\nexport default connect(mapStateToProps)(withRouter(Sound));","map":{"version":3,"sources":["/Users/eun/Projects/FirstPenguin/first-penguin/front/src/Routes/Therapy/T5_Sound/SoundContainer.js"],"names":["React","withRouter","SoundPresenter","PropTypes","connect","T5","TTobak","Characters","T_Api2","soundURL","T_tutorial","LoadingComp","initState","TTobaki","ttobak1_1","gameState","CardTextList","isImageLoaded","showPopup","showDonePopup","showDailyPopup","percent","currentIndex","totalNum","Sound","Component","constructor","match","newRequest","console","log","user","props","s_id","student","data","ask","type","code","tutorial","cure","currentCure","is_first","setAudio","setState","cure_word","cure_word2","length","setTimeout","playSound","message","daily","location","state","voice","Audio","tut_voice","voc_path","sample_ques","currentAudio","cure_path","addEventListener","play","answer","cure_id","learning_type","remove","Math","floor","random","tmp","cure_path2","ttobak1_2","onTTobakiTouchHandle","onCardTouchHandle","index","correct_voice","voc_desc","retry_script","ttobak3_2","ttobak2_2","good_script","nextStep","gameDone","imagesPreloading","picture","timeoutPreloading","history","push","i","prop","img","Image","src","onload","numOfLoadedImage","totalImages","clearTimeout","onContinueButtonHandle","onRestartButtonHandle","onPauseButtonHandle","params","Object","keys","componentDidMount","u_id","componentWillUnmount","pause","render","t5_background","card1","card2","propTypes","objectOf","any","isRequired","dispatch","func","mapStateToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport SoundPresenter from './SoundPresenter';\n\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\n\nimport { T5, TTobak, Characters } from 'images';\nimport { T_Api2, soundURL, T_tutorial } from 'api';\nimport LoadingComp from 'Components/LoadingComp';\n\nconst initState = {\n    TTobaki: TTobak.ttobak1_1,                  // 또박이 이미지 상태\n    gameState: false,\n    CardTextList: null,\n    isImageLoaded: false,\n    showPopup: false,\n    showDonePopup: false,\n    showDailyPopup: false,\n    percent: 0,\n    currentIndex: 1,\n    totalNum: 0,\n}\n\nclass Sound extends React.Component {\n    static propTypes = {\n        user: PropTypes.objectOf(PropTypes.any).isRequired,\n        dispatch: PropTypes.func.isRequired,\n    };\n\n    constructor({ match }) {\n        super();\n        this.learning_type = match.params.learning_type;\n        this.type = match.params.type + 'sound';\n        this.cure = null;\n        this.currentCure = null;\n        this.currentIndex = 0;\n        this.currentAudio = null;\n        this.numOfLoadedImage = 0;\n        this.picture = { T5, TTobak, Characters };\n        this.totalImages = Object.keys(T5).length + Object.keys(TTobak).length + Object.keys(Characters).length;\n\n        this.state = initState;\n    }\n\n    async componentDidMount() {\n        const { user } = this.props;\n\n        if (!user.user.u_id || !user.student.s_id) {\n            this.props.history.push('/root/signin');\n            return;\n        }\n\n        this.imagesPreloading(this.picture);\n    }\n\n    componentWillUnmount() {\n        if (!!this.currentAudio) {\n            this.currentAudio.pause();\n            this.currentAudio.remove();\n            this.currentAudio = null;\n        }\n\n        if (!!this.voice) {\n            for (let i = 0; i < this.voice.length; i++) {\n                if (!!this.voice[i]) {\n                    this.voice[i].pause();\n                    this.voice[i].remove();\n                    this.voice[i] = null;\n                }\n            }\n        }\n    }\n\n    newRequest = async () => {\n        console.log('new request');\n\n        const { user } = this.props;\n        const s_id = user.student.s_id;\n        const { data } = await T_Api2.ask(s_id, this.type);\n        console.log(data);\n\n        if (data.code === 'tutorial') {\n            this.tutorial(data);\n            return;\n        }\n\n        if (data.code === 'specified' || data.code === 1) {\n            this.currentIndex = 0;\n            this.cure = data.cure;\n            this.currentCure = data.cure[this.currentIndex];\n            this.currentCure.is_first = 'T';\n            this.setAudio();\n\n            this.setState({\n                CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n                totalNum: this.cure.length,\n                currentIndex: this.currentIndex + 1,\n            });\n            setTimeout(() => this.playSound(), 2000);\n        }\n        else console.log('data message: ' + data.message);\n    }\n\n    daily = () => {\n        if (this.props.location.state.data.code === 'tutorial') {\n            this.tutorial(this.props.location.state.data);\n            return;\n        }\n\n        console.log(this.props.location.state.data.cure);\n        this.cure = this.props.location.state.data.cure;\n        this.currentCure = this.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        this.setAudio();\n\n        this.setState = {\n            totalNum: this.cure.length,\n            CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n            currentIndex: this.currentIndex + 1,\n        };\n        setTimeout(() => this.playSound(), 2000);\n    }\n\n    tutorial = (data) => {\n        this.voice = [\n            new Audio(soundURL + data.tut_voice[0].voc_path),\n            new Audio(soundURL + data.tut_voice[1].voc_path),\n            new Audio(soundURL + data.tut_voice[2].voc_path),\n        ];\n        this.currentCure = data.sample_ques;\n        this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n\n        this.currentAudio.addEventListener('ended', () => {\n            this.setState({ TTobaki: TTobak.ttobak1_1 })\n            setTimeout(() => {\n                this.voice[1].play();\n            }, 1000);\n        })\n\n        this.setState({\n            CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n        });\n\n        this.voice[0].addEventListener('ended', () => {\n            setTimeout(() => {\n                this.playSound();\n            }, 1000);\n        });\n\n        this.voice[1].addEventListener('ended', () => {\n            this.setState({\n                gameState: 'tutorial',\n                TTobaki: TTobak.ttobak1_1,\n            });\n        });\n\n        this.voice[2].addEventListener('ended', async () => {\n            const { data } = await T_tutorial.answer(this.props.user.student.s_id, this.type, this.currentCure.cure_id);\n            console.log(data);\n            this.setState({\n                gameState: false,\n            });\n            if (this.learning_type === 'daily') this.daily();\n            else this.newRequest();\n        });\n\n        setTimeout(() => {\n            this.voice[0].play();\n        }, 2000);\n    }\n\n    setAudio = () => {\n        if (!!this.currentAudio) {\n            this.currentAudio.remove();\n            this.currentAudio = null;\n        }\n        if (this.type === 'consosound') {\n            this.currentCure.answer = Math.floor(Math.random() * 2) + 1;\n            this.currentAudio = new Audio(soundURL + this.currentCure.cure_path);\n            if (this.currentCure.answer === 2) {\n                var tmp = this.currentCure.cure_word;\n                this.currentCure.cure_word = this.currentCure.cure_word2;\n                this.currentCure.cure_word2 = tmp;\n            }\n        } else {\n            this.currentAudio = this.currentCure.answer === 1\n                ? new Audio(soundURL + this.currentCure.cure_path) :\n                new Audio(soundURL + this.currentCure.cure_path2);\n        }\n\n        this.currentAudio.addEventListener('ended', () => {\n            setTimeout(() => {\n                this.voice[1].play();\n            }, 1000);\n        })\n    }\n\n    playSound = () => {\n        if (!!this.currentAudio) {\n            this.setState({\n                gameState: false,\n                TTobaki: TTobak.ttobak1_2\n            });\n            this.currentAudio.play();\n        }\n    }\n\n    onTTobakiTouchHandle = () => {\n        const { gameState } = this.state;\n        if (gameState) this.playSound();\n    }\n\n    onCardTouchHandle = async (index) => {\n        const { gameState, CardTextList } = this.state;\n        const { user } = this.props;\n        const s_id = user.student.s_id;\n\n        if (gameState === 'tutorial') {\n            if (index === 1) {\n                this.setState({ gameState: false })\n                setTimeout(() => {\n                    this.voice[2].play();\n                }, 1000);\n            }\n            return;\n        }\n        if (!gameState) return;\n\n        this.setState({\n            gameState: false,\n        });\n\n        const { data } = await T_Api2.answer(\n            s_id,\n            this.currentCure.answer === 1 ? this.currentCure.cure_word : this.currentCure.cure_word2,\n            CardTextList[index],\n            this.currentCure.cure_id,\n            this.learning_type === 'review' ? 'T' : 'F',\n            this.type,\n            this.learning_type === 'daily' ? 'T' : 'F',\n            this.currentCure.is_first\n        );\n        console.log(data);\n\n        if (data.code === 1) {\n            if (data.correct_voice.voc_desc === 'retry') {\n                this.currentCure.is_first = 'F';\n                this.retry_script = new Audio(soundURL + data.correct_voice.voc_path);\n                this.retry_script.addEventListener('ended', () => {\n                    this.setState({\n                        TTobaki: TTobak.ttobak1_1,\n                        gameState: true,\n                    });\n                });\n\n                setTimeout(() => {\n                    this.retry_script.play();\n                    this.setState({\n                        TTobaki: TTobak.ttobak3_2,\n                        gameState: false,\n                    });\n                }, 1000);\n                return;\n            } else {\n                this.setState({\n                    TTobaki: TTobak.ttobak2_2,\n                })\n                this.good_script = new Audio(soundURL + data.correct_voice.voc_path);\n                this.good_script.addEventListener('ended', () => this.nextStep());\n                setTimeout(() => {\n                    this.good_script.play();\n                    this.setState({\n                        gameState: false,\n                    });\n                }, 1000);\n            }\n        } else if (data.code === 2) {\n            this.setState({\n                showPopup: true,\n            })\n        }\n    }\n\n    nextStep = () => {\n        if (this.currentIndex < this.cure.length - 1) this.currentIndex++;\n        else {\n            setTimeout(() => {\n                this.gameDone();\n            }, 1000);\n            return;\n        }\n        this.currentCure = this.cure[this.currentIndex];\n        this.currentCure.is_first = 'T';\n        this.setAudio();\n\n        setTimeout(() => {\n            this.setState({\n                CardTextList: [this.currentCure.cure_word, this.currentCure.cure_word2],\n                TTobaki: TTobak.ttobak1_1,\n                currentIndex: this.currentIndex + 1\n            });\n        }, 1000);\n\n        setTimeout(() => {\n            this.playSound();\n        }, 2000);\n    }\n\n    gameDone = () => {\n        console.log('game doen!');\n        if (this.learning_type !== 'daily') {\n            this.setState({\n                showDonePopup: true,\n            })\n        } else {\n            this.setState({\n                showDailyPopup: true,\n            })\n        }\n    }\n\n    imagesPreloading = (picture) => {\n        let timeoutPreloading = setTimeout(() => {\n            this.props.history.push('/main/main');\n        }, 10000);\n\n        for (let i in picture) {\n            for (let prop in picture[i]) {\n                let img = new Image();\n                img.src = picture[i][prop];\n                img.onload = () => {\n                    this.setState({\n                        percent: (++this.numOfLoadedImage / this.totalImages) * 100\n                    });\n\n                    if (this.numOfLoadedImage === this.totalImages) {\n                        this.setState({\n                            isImageLoaded: true,\n                            TTobaki: TTobak.ttobak1_1,\n                        })\n                        clearTimeout(timeoutPreloading);\n                        if (this.learning_type !== 'daily') this.newRequest();\n                        else this.daily();\n                    }\n                };\n            }\n        }\n    }\n\n    onContinueButtonHandle = () => {\n        this.setState({\n            showPopup: false,\n        })\n    }\n\n    onRestartButtonHandle = () => {\n        this.setState({\n            showDonePopup: false,\n        })\n        this.newRequest();\n        setTimeout(() => this.playSound(), 2000);\n    }\n\n    onPauseButtonHandle = () => {\n        this.setState({\n            showPopup: true,\n        })\n    }\n\n    render() {\n        const { TTobaki, CardTextList, isImageLoaded, showPopup, showDonePopup, showDailyPopup, percent, gameState,\n            currentIndex, totalNum } = this.state;\n        if (isImageLoaded) {\n            return (<SoundPresenter\n                Background={T5.t5_background}\n                TTobak={TTobaki}\n                TTobakiTouch={this.onTTobakiTouchHandle}\n                Card={[Characters.card1, Characters.card2]}\n                CardTextList={CardTextList || ['아', '에']}\n                onCardTouchHandle={this.onCardTouchHandle}\n                onContinueButtonHandle={this.onContinueButtonHandle}\n                onRestartButtonHandle={this.onRestartButtonHandle}\n                onPauseButtonHandle={this.onPauseButtonHandle}\n                showPopup={showPopup}\n                showDailyPopup={showDailyPopup}\n                showDonePopup={showDonePopup}\n                gameState={gameState}\n                currentIndex={currentIndex}\n                totalNum={totalNum}\n            />);\n        }\n        else {\n            return <LoadingComp percent={percent} />\n        }\n    }\n}\n\nfunction mapStateToProps(state) {\n    return { user: state.user }\n}\n\nexport default connect(mapStateToProps)(withRouter(Sound));"]},"metadata":{},"sourceType":"module"}